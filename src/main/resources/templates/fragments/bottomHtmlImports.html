<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="bg">

<!--
  BOTTOM HTML IMPORTS - ОПТИМИЗИРАН ЗА ПО-ДОБРА ПРОИЗВОДИТЕЛНОСТ
  ============================================================
-->

<div th:fragment="bottomImports">
    <script src="/js/loader.js"></script>

    <!-- SockJS Client Library за WebSocket комуникация -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>

    <!-- STOMP over SockJS Client Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

    <!-- CORE SCRIPTS - Основни функционалности -->

    <!-- Navbar functionality (включва ToastManager) -->
    <script src="/js/navbar.js"></script>

    <!-- Cart functionality (зарежда се след navbar) -->
    <script src="/js/cart.js"></script>
    <script src="/js/cartPanel.js"></script>

    <!-- Order Management Scripts -->
    <script src="/js/order-detail.js"></script>
    <script src="/js/orders-nav.js"></script>

    <!-- INITIALIZATION SCRIPT -->
    <script>
        // Проверява дали всички необходими обекти са инициализирани
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== SYSTEM INITIALIZATION ===');

            // Проверка за ToastManager
            if (window.toastManager) {
                console.log('✓ ToastManager инициализиран');
            } else {
                console.warn('✗ ToastManager не е инициализиран');
            }

            // Проверка за CartManager
            if (window.cartManager) {
                console.log('✓ CartManager инициализиран');
            } else {
                console.warn('✗ CartManager не е инициализиран');
            }

            // Проверка за CartPanel
            if (window.cartPanel) {
                console.log('✓ CartPanel инициализиран');
            } else {
                console.warn('✗ CartPanel не е инициализиран');
            }

            // Проверка за CSRF токен
            if (window.csrfToken) {
                console.log('✓ CSRF токен настроен');
            } else {
                console.warn('✗ CSRF токен не е настроен');
            }

            console.log('=== INITIALIZATION COMPLETE ===');
        });
    </script>

</div>

</html>