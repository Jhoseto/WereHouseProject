<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="bg">
<body>
<section th:object="${order}">
    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <a th:href="@{/orders}" class="breadcrumb-link">–ú–æ–∏—Ç–µ –∑–∞—è–≤–∫–∏</a>
        <span class="breadcrumb-separator">/</span>
        <span>–ó–∞—è–≤–∫–∞ #<span th:text="*{id}">0</span></span>
    </div>

    <div class="order-header">
        <h1>
            üìã –ó–∞—è–≤–∫–∞ ‚Ññ <span th:text="*{id}" class="order-number">0</span>
        </h1>

        <div class="order-status-badge">
      <span th:class="'status-badge status-' + ${#strings.toLowerCase(order.status.name())}"
            th:text="*{status.name()}"
            th:attr="data-tooltip=${order.status.name() == 'SUBMITTED' ? '–û—á–∞–∫–≤–∞ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : 
                                 (order.status.name() == 'CONFIRMED' ? '–ü–æ—Ç–≤—ä—Ä–¥–µ–Ω–∞ –∏ —Å–µ –æ–±—Ä–∞–±–æ—Ç–≤–∞' :
                                 (order.status.name() == 'SHIPPED' ? '–ò–∑–ø—Ä–∞—Ç–µ–Ω–∞ –∑–∞ –¥–æ—Å—Ç–∞–≤–∫–∞' :
                                 (order.status.name() == 'CANCELLED' ? '–ó–∞—è–≤–∫–∞—Ç–∞ –µ –æ—Ç–º–µ–Ω–µ–Ω–∞' : order.status.name())))}">
        SUBMITTED
      </span>
        </div>
    </div>

    <!-- Order information -->
    <div class="order-info-grid">
        <div class="order-info-card">
            <h3>üìÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –∑–∞—è–≤–∫–∞—Ç–∞</h3>
            <div class="info-row">
                <span class="info-label">–ü–æ–¥–∞–¥–µ–Ω–∞ –Ω–∞:</span>
                <span class="info-value" th:text="${#temporals.format(order.submittedAt, 'dd.MM.yyyy HH:mm:ss')}">01.01.2025 12:00:00</span>
            </div>
            <div th:if="*{confirmedAt != null}" class="info-row">
                <span class="info-label">–ü–æ—Ç–≤—ä—Ä–¥–µ–Ω–∞ –Ω–∞:</span>
                <span class="info-value" th:text="${#temporals.format(order.confirmedAt, 'dd.MM.yyyy HH:mm:ss')}">01.01.2025 13:00:00</span>
            </div>
            <div th:if="*{notes != null and not #strings.isEmpty(notes)}" class="info-row">
                <span class="info-label">–ë–µ–ª–µ–∂–∫–∏:</span>
                <div class="info-value notes-content" th:text="*{notes}">Order notes</div>
            </div>
        </div>

        <!-- Order summary -->
        <div class="order-summary-card">
            <h3>üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="summary-row">
                <span>–ù–µ—Ç–æ —Å—É–º–∞:</span>
                <span th:text="${#numbers.formatDecimal(order.totalNet,1,2)} + ' –ª–≤'">0.00 –ª–≤</span>
            </div>
            <div class="summary-row">
                <span>–î–î–°:</span>
                <span th:text="${#numbers.formatDecimal(order.totalVat,1,2)} + ' –ª–≤'">0.00 –ª–≤</span>
            </div>
            <div class="summary-row total-row">
                <span>–ö—Ä–∞–π–Ω–∞ —Å—É–º–∞:</span>
                <strong class="total-amount" th:text="${#numbers.formatDecimal(order.totalGross,1,2)} + ' –ª–≤'">0.00 –ª–≤</strong>
            </div>
        </div>
    </div>

    <!-- Order items -->
    <div class="order-items-section">
        <h3>üì¶ –ü—Ä–æ–¥—É–∫—Ç–∏ –≤ –∑–∞—è–≤–∫–∞—Ç–∞</h3>

        <div class="table-responsive">
            <table class="table order-items-table">
                <thead>
                <tr>
                    <th>SKU</th>
                    <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                    <th>–ö-–≤–æ</th>
                    <th>–ï–¥. —Ü–µ–Ω–∞</th>
                    <th>–û–±—â–æ</th>
                    <th>–ë–µ–ª–µ–∂–∫–∞</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="item : *{items}" class="order-item-row">
                    <td class="sku-cell">
                        <code th:text="${item.product.sku}">SKU</code>
                    </td>
                    <td class="product-cell">
                        <div class="product-name" th:text="${item.product.name}">Product Name</div>
                        <div th:if="${item.product.category}" class="product-category">
                            <span class="category-badge" th:text="${item.product.category}">Category</span>
                        </div>
                    </td>
                    <td class="quantity-cell">
                        <span class="quantity" th:text="${#numbers.formatDecimal(item.qty, 0, 0)}">1</span>
                        <span class="unit" th:text="${item.product.unit}">pcs</span>
                    </td>
                    <td class="price-cell">
                        <span th:text="${#numbers.formatDecimal(item.unitPrice,1,2)} + ' –ª–≤'">0.00 –ª–≤</span>
                    </td>
                    <td class="total-cell">
                        <strong th:text="${#numbers.formatDecimal(item.unitPrice.multiply(item.qty),1,2)} + ' –ª–≤'">0.00 –ª–≤</strong>
                    </td>
                    <td class="note-cell">
              <span th:if="${item.note != null and not #strings.isEmpty(item.note)}"
                    class="item-note"
                    th:text="${item.note}">
                Note
              </span>
                        <span th:unless="${item.note != null and not #strings.isEmpty(item.note)}"
                              class="text-muted">‚Äî</span>
                    </td>
                </tr>
                </tbody>
                <tfoot>
                <tr class="totals-row">
                    <td colspan="4" class="totals-label">–û–±—â–æ:</td>
                    <td class="totals-value">
                        <strong th:text="${#numbers.formatDecimal(order.totalNet,1,2)} + ' –ª–≤'">0.00 –ª–≤</strong>
                    </td>
                    <td></td>
                </tr>
                <tr class="totals-row">
                    <td colspan="4" class="totals-label">–î–î–°:</td>
                    <td class="totals-value">
                        <strong th:text="${#numbers.formatDecimal(order.totalVat,1,2)} + ' –ª–≤'">0.00 –ª–≤</strong>
                    </td>
                    <td></td>
                </tr>
                <tr class="grand-total-row">
                    <td colspan="4" class="totals-label">–ö—Ä–∞–π–Ω–∞ —Å—É–º–∞:</td>
                    <td class="totals-value">
                        <strong class="grand-total" th:text="${#numbers.formatDecimal(order.totalGross,1,2)} + ' –ª–≤'">0.00 –ª–≤</strong>
                    </td>
                    <td></td>
                </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <!-- Actions -->
    <div class="order-actions">
        <a th:href="@{/orders}" class="btn btn-secondary">
            <span class="nav-icon">üìã</span> –û–±—Ä–∞—Ç–Ω–æ –∫—ä–º –∑–∞—è–≤–∫–∏—Ç–µ
        </a>

        <button onclick="window.print()" class="btn btn-secondary">
            <span class="nav-icon">üñ®Ô∏è</span> –ü—Ä–∏–Ω—Ç–∏—Ä–∞–π
        </button>

        <a th:href="@{/catalog}" class="btn">
            <span class="nav-icon">üì¶</span> –ù–æ–≤–∞ –∑–∞—è–≤–∫–∞
        </a>
    </div>
</section>

<style>
    .order-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 25px;
        flex-wrap: wrap;
        gap: 15px;
    }

    .order-number {
        color: #3498db;
        font-family: monospace;
    }

    .order-status-badge {
        align-self: flex-start;
    }

    .order-info-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 25px;
        margin-bottom: 30px;
    }

    .order-info-card, .order-summary-card {
        background: white;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .order-info-card h3, .order-summary-card h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
    }

    .info-row {
        display: flex;
        margin-bottom: 12px;
        align-items: flex-start;
    }

    .info-label {
        font-weight: 600;
        color: #2c3e50;
        min-width: 120px;
        margin-right: 15px;
    }

    .info-value {
        color: #495057;
        flex: 1;
    }

    .notes-content {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        border-left: 3px solid #3498db;
        white-space: pre-wrap;
        font-style: italic;
    }

    .summary-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #f8f9fa;
    }

    .total-row {
        font-size: 1.1rem;
        font-weight: 600;
        margin-top: 10px;
        padding-top: 15px;
        border-top: 2px solid #eee;
        border-bottom: none;
    }

    .total-amount {
        color: #27ae60;
        font-size: 1.2rem;
    }

    .order-items-section {
        background: white;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-bottom: 25px;
    }

    .order-items-section h3 {
        margin: 0 0 20px 0;
        color: #2c3e50;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
    }

    .order-items-table .sku-cell {
        font-family: monospace;
        background: #f8f9fa;
    }

    .order-items-table .sku-cell code {
        background: none;
        color: #2c3e50;
        font-weight: 600;
    }

    .product-name {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 4px;
    }

    .category-badge {
        display: inline-block;
        background: #e9ecef;
        color: #495057;
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 0.7rem;
        font-weight: 600;
    }

    .quantity-cell {
        text-align: center;
    }

    .quantity {
        font-weight: 600;
        font-size: 1.1rem;
    }

    .unit {
        color: #6c757d;
        font-size: 0.85rem;
        margin-left: 4px;
    }

    .price-cell, .total-cell {
        text-align: right;
        font-family: monospace;
    }

    .total-cell strong {
        color: #27ae60;
    }

    .item-note {
        font-style: italic;
        color: #6c757d;
        font-size: 0.9rem;
        background: #f8f9fa;
        padding: 4px 8px;
        border-radius: 4px;
    }

    .totals-row, .grand-total-row {
        background: #f8f9fa;
    }

    .totals-label {
        text-align: right;
        font-weight: 600;
        color: #2c3e50;
    }

    .totals-value {
        text-align: right;
        font-family: monospace;
    }

    .grand-total-row {
        background: #e8f5e8;
    }

    .grand-total {
        color: #27ae60;
        font-size: 1.1rem;
    }

    .order-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-top: 30px;
        flex-wrap: wrap;
    }

    /* Print styles */
    @media print {
        .breadcrumbs,
        .order-actions,
        .site-header,
        .site-footer,
        .flash-messages {
            display: none !important;
        }

        body {
            background: white !important;
        }

        .container {
            max-width: none !important;
            padding: 0 !important;
        }

        .order-info-card, .order-summary-card, .order-items-section {
            box-shadow: none !important;
            border: 1px solid #ddd;
        }

        .status-badge {
            border: 1px solid #ddd !important;
        }
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .order-header {
            flex-direction: column;
            align-items: flex-start;
        }

        .order-info-grid {
            grid-template-columns: 1fr;
        }

        .order-items-table {
            font-size: 0.85rem;
        }

        .info-row {
            flex-direction: column;
        }

        .info-label {
            min-width: auto;
            margin-right: 0;
            margin-bottom: 4px;
        }

        .order-actions {
            flex-direction: column;
        }
    }

    @media (max-width: 576px) {
        .order-items-table th:nth-child(4),
        .order-items-table td:nth-child(4),
        .order-items-table th:nth-child(6),
        .order-items-table td:nth-child(6) {
            display: none; /* Hide unit price and notes on mobile */
        }

        .summary-row {
            font-size: 0.9rem;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Animate numbers on load
        const numberElements = document.querySelectorAll('.total-amount, .grand-total');
        numberElements.forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(20px)';

            setTimeout(() => {
                el.style.transition = 'all 0.5s ease';
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            }, 100);
        });
    });
</script>
</body>
</html>